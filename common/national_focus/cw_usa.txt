focus_tree = {
    id = cw_usa_focus
    country = {
        factor = 0
        modifier = {
            add = 100
            tag = USA
            has_start_date > 1945.01.01
        }
    }
    default = no
	continuous_focus_position = { x = 650 y = 1350 }

    focus = {   #passed despite Trumans veto
        id = USA_outlaw_strikes
        icon = GFX_focus_eng_concessions_to_the_trade_unions
        x = 5
        y = 0
        
    }

    focus = {
        id = USA_the_fair_deal
        icon = GFX_Goal_USA_new_deal
        x = 0
        y = 1
        relative_position_id = USA_outlaw_strikes
        prerequisite = {
            focus = USA_outlaw_strikes
        }
    }

    focus = {
		id = USA_desegregate_the_armed_forces_cw
        text = USA_desegregate_the_armed_forces
		icon = GFX_Goal_USA_Desegregated_military
		x = 3
		y = 0
		cost = 10

		ai_will_do = {
			factor = 1
		}

		available = {
			OR = {
				communism > 0.1
				has_country_leader = { ruling_only = yes name = "Harry S. Truman" }
				has_country_leader = { ruling_only = yes character = USA_wendell_willkie }
			}
		}
		
		
		search_filters = {FOCUS_FILTER_MANPOWER}
		completion_reward = {
			add_ideas = USA_armed_forces_desegregation
		}
	}

    focus = {   #anytime
        id = USA_aid_for_asia
        icon = GFX_focus_usa_focus_on_asia
        cost = 5
        x = 17
        y = 0
        bypass = {
            NOT = {
                any_other_country = {
                    OR = { 
                        has_government = democratic
                        tag = CHI
                    }
                    capital_scope = {
                        is_on_continent = asia
                    }
                    OR = {
                        is_subject = no
                        is_subject_of = ROOT
                    }
                }
            }
        }
        completion_reward = {
            #buff Japan somehow
            every_other_country = {
                limit = {
                    OR = {
                        has_government = democratic
                        tag = CHI
                    }
                    capital_scope = {
                        is_on_continent = asia
                    }
                    OR = {
                        is_subject = no
                        is_subject_of = ROOT
                    }
                }
                add_timed_idea = {
                    idea = USA_marshall_plan_aid_idea
                    days = 1440
                }
            }
        }
    }
    focus = {
        id = USA_deal_with_siam
        icon = GFX_goal_generic_befriend_siam
        cost = 5
        x = 1
        y = 1
        relative_position_id = USA_aid_for_asia
        prerequisite = {
            focus = USA_aid_for_asia
        }
        available = {
            SIA = {
                exists = yes
                NOT = {
                    has_war_with = ROOT
                }
            }
        }
        completion_reward = {
            SIA = {
                country_event = cold_war.19
                effect_tooltip = {
                    custom_effect_tooltip = if_they_accept
                    add_timed_idea = {
                        idea = USA_marshall_plan_aid_idea
                        days = 1440
                    }
                    every_state = {
                        limit = {
                            OR = {
                                is_owned_by = PREV
                                owner = {
                                    is_subject_of = PREV
                                }
                            }
                            is_core_of = FRI
                        }
                        if = {
                            limit = {
                                FRI = {
                                    exists = yes
                                }
                            }
                            transfer_state_to = FRI
                        }
                        else = {
                            if = {
                                limit = {
                                    CAM = {
                                        exists = yes
                                        is_subject = no
                                    }
                                }
                                if = {
                                    limit = {
                                        is_core_of = CAM
                                    }
                                    transfer_state_to = CAM
                                }
                            }
                            if = {
                                limit = {
                                    LAO = {
                                        exists = yes
                                        is_subject = no
                                    }
                                }
                                if = {
                                    limit = {
                                        is_core_of = LAO
                                    }
                                    transfer_state_to = LAO
                                }
                            }
                        }
                    }
                }
            }
        }
    }

    focus = {   #may 1946
        id = USA_independence_for_the_phillipines
        icon = GFX_goal_philippines_democracy
        cost = 2
        x = 0
        y = 2

        prerequisite = {
            focus = USA_aid_for_asia
        }

        relative_position_id = USA_aid_for_asia
        available = {
            has_subject = PHI
        }
        completion_reward = {
            set_autonomy = {
                target = PHI
                autonomy_state = autonomy_free
            }
        }
    }

    focus = {   #ahist
        id = USA_disavow_marshall_mission
        icon = GFX_goal_kmt_china
        cost = 2
        x = 3
        y = 1

        prerequisite = {
            focus = USA_aid_for_asia
        }

        relative_position_id = USA_aid_for_asia
        available = {
            CHI = {
                has_war = yes
                NOT = {
                    has_war_with = ROOT
                }
            }
        }
        completion_reward = {
            CHI = {
                set_country_flag = FRA_arms_purchases_permitted
                unlock_decision_category_tooltip = CHI_weapons_purchases_category
            }
            if = {
                limit = {
                    has_dlc = "Arms Against Tyranny"
                }
                give_market_access = CHI    #tooltip might be bugged
            }
        }
    }

	#political

    focus = {   #May 1947
		id = USA_aid_the_recovery_of_europe #about 5% of yearly GDP spread over 4 years
		icon = GFX_goal_generic_bills
		x = 14
		y = 1
		cost = 10

        available = {

        }
		
		search_filters = {FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH}
		completion_reward = {
            add_timed_idea = {
                idea = r56_financing_marshall_plan
                days = 360
            }
            every_country = {
                limit = {
                    NOT = {
                        has_war_with =  ROOT
                    }
                    OR = {
                        any_subject_country = {
                            capital_scope = {
                                is_on_continent = europe
                            }
                        }
                        AND = {
                            capital_scope = {
                                is_on_continent = europe
                            }
                            NOT = {
                                original_tag = FIN
                                has_government = fascism #Bad Franco!
                                is_subject = yes
                            }
                        }
                    }
                }
                country_event = cold_war.4
            }
		}
	}
    focus = {
        id = USA_oppose_communist_coalition_governments
        icon = GFX_focus_generic_strike_at_democracy2
        cost = 2
        prerequisite = {
            focus = USA_aid_the_recovery_of_europe
        }
        prerequisite = {
            focus = USA_formalize_the_truman_doctrine #this requirement makes sense, but might make the timeline difficult
        }
        x = -2
        y = 1
        relative_position_id = USA_aid_the_recovery_of_europe
        available = {
            
        }
    }
    focus = {
        id = USA_pressure_netherlands_over_indonesia
        icon = GFX_dutch_east_indies
        cost = 2
        prerequisite = {
            focus = USA_aid_the_recovery_of_europe
        }
        x = 0
        y = 1
        relative_position_id = USA_aid_the_recovery_of_europe
        available = {
            date > 1948.01.01
            HOL = {
                has_idea = USA_marshall_plan_aid_idea
                has_war_with = INS
            }
            INS = {
                NOT = {
                    has_war_with = ROOT
                }
                surrender_progress < 0.6
            }
        }
        completion_reward = {
            HOL = {
                country_event = cold_war.18
            }
        }
    }

    focus = {   #end of 1946
        id = USA_greece_non_intervention_agreement
        icon = GFX_goal_generic_befriend_greece
        cost = 10
        x = 8
        y = 0
        available = {
            NOT = {
                has_completed_focus = USA_formalize_the_truman_doctrine
            }
        }
        completion_reward = {
            SOV = {
                #country_event = 
            }
        }
    }

    focus = {   #announced March 1947, made concrete July 1948
        id = USA_formalize_the_truman_doctrine #support any countries threatened by communism
        icon = GFX_goal_anti_comintern_pact
        cost = 10
		x = 8
		y = 1
        completion_reward = {
            set_rule = {
                can_send_volunteers = yes
                can_boost_other_ideologies = yes
            }
        }
    }

    focus = {
        id = USA_loyalty_review_program
        icon = GFX_goal_attack_communists
        x = -2
		y = 1
		prerequisite = { focus = USA_formalize_the_truman_doctrine }
		relative_position_id = USA_formalize_the_truman_doctrine
    }

    focus = {
		id = USA_rio_treaty
		icon = GFX_goal_generic_positive_trade_relations
		x = 1
		y = 2
		prerequisite = { focus = USA_formalize_the_truman_doctrine }
		relative_position_id = USA_formalize_the_truman_doctrine
		cost = 10
		ai_will_do = {
			factor = 2
			modifier = {
				factor = 80
				original_tag = USA
				has_government = democratic
				NOT = {
					has_idea_with_trait = fascist_demagogue
				}
				NOT = {
					has_idea_with_trait = communist_revolutionary
				}		
				NOT = {
					any_other_country = {
						has_government = democratic
						is_faction_leader = yes 
					} 
				}
				NOT = {
					is_in_faction = yes
				}
			}
		}
		completion_reward = {
			custom_effect_tooltip = USA_reinforce_monroe_doctrine_tt
			unlock_decision_category_tooltip = USA_intervention_mandate
			hidden_effect = {
				CUB = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				HAI = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				DOM = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				GUA = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				ELS = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				HON = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				NIC = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				COS = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				CAN = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				MEX = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				COL = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				VEN = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				ECU = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				PRU = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				BRA = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				BOL = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				PAR = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				URG = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				ARG = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				CHL = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
				PAN = { add_opinion_modifier =  { target = USA modifier = monroe_doctrine_trade } }
			}
		}
	}
    
    focus = {   #Sep 1947
        id = USA_form_the_cia
        icon = GFX_goal_CAN_CAMP_X
        cost = 5
        prerequisite = {
            focus = USA_formalize_the_truman_doctrine
        }
		x = 0
		y = 1
        relative_position_id = USA_formalize_the_truman_doctrine
        completion_reward = {
            custom_effect_tooltip = USA_CIA_tt
            create_intelligence_agency = {
                name = "Central Intelligence Agency"
                #icon = GFX_intelligence_agency_logo_agency
            }
        }
    }

    focus = {
		id = USA_treaty_of_san_francisco
		icon = GFX_goal_generic_befriend_japan_alt
		x = -1
		y = 1
        relative_position_id = USA_aid_for_asia
		cost = 10

        prerequisite = {
            focus = USA_aid_for_asia
        }

        available = {
            JAP = {
                exists = no
            }
        }
		
		search_filters = {FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH}
		completion_reward = {
            JAP = {
                remove_state_core = 537
            }
			release = JAP
            transfer_state = 646
            hidden_effect = {   #already sort of in place
                JAP = {
                    add_ideas = {
                        JAP_hirohito
                    }
                    set_politics = {
                        ruling_party = democratic
                        elections_allowed = yes
                        last_election = "1948.10.1"
                        election_frequency = 48     #seems to rarely get this far
                    }
                    set_popularities = {
                        democratic = 55
                        neutrality = 0
                        fascism = 35
                        communism = 10
                    }
                    create_country_leader = {
                        name = "Shigeru Yoshida"
                        ideology = liberalism
                        expire = "1967.10.20"
                        traits = {

                        }
                    }
                }
            }
		}
	}
    focus = {   #1949, should be very closely tied to other world events
        id = USA_cw_form_nato
        icon = GFX_focus_chi_mission_to_the_us
        text = r56_USA_foundation_of_NATO
        cost = 5
        x = 2
        y = 1
        relative_position_id = USA_formalize_the_truman_doctrine
        prerequisite = {
            focus = USA_aid_the_recovery_of_europe
        }
        prerequisite = {
            focus = USA_formalize_the_truman_doctrine
        }
        completion_reward = {
            create_faction = USA_nato_faction
            every_country = {
                if = {
                    limit = {
                        OR = {
                            AND = {
                                is_faction_leader = yes
                                OR = {
                                    original_tag = FRA
                                    original_tag = ENG
                                }
                            }
                            is_in_faction_with = FRA
                            is_in_faction_with = ENG
                        }
                    }
                    add_to_faction = ROOT
                }
                else_if = {
                    limit = {
                        has_government = democratic
                        capital_scope = {
                            is_on_continent = europe
                        }
                        NOT = {
                            original_tag = SWE
                            original_tag = FIN
                            original_tag = SWI
                            original_tag = IRE
                            #greece?
                        }
                    }
                    country_event = generic.5
                }
            }
        }
    }
}
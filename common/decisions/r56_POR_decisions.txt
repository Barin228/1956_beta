form_nation_mod_category = {
	POR_unshackle_galicia = {
		icon = generic_form_nation
		fire_only_once = yes	
		cost = 45
		allowed = { original_tag = POR }
		visible = {
			has_focus_tree = r56_portuguese_focus
			NOT = {
				171 = { is_core_of = POR }
				171 = { is_claimed_by = POR }
			}
		}
		highlight_states = {
			highlight_state_targets = { 
			   state = 171
		   	} 
	   	}
		available = { controls_state = 171 }
		complete_effect = {
			add_state_claim = 171
			unlock_decision_tooltip = POR_integrate_galicia
			hidden_effect = { 
				remove_dynamic_modifier = { modifier = autonomous_state }
			}
		}
	}

	POR_integrate_galicia = {
		icon = generic_form_nation
		fire_only_once = yes	
		cost = 60

		allowed = { original_tag = POR }

		visible = {
			171 = { is_claimed_by = POR }
			NOT = { 
				171 = { is_core_of = POR }
			}
		}

		highlight_states = {
			highlight_state_targets = { 
			   state = 171
		    } 
		}

		available = {
			171 = {
				is_fully_controlled_by = POR
				compliance > 35
				resistance < 3
			}
		}

		days_remove = 90
		modifier = {
     		political_power_gain = -0.15
		}

		remove_effect = {
			add_popularity = { 
				ideology = ROOT 
				popularity = 0.05
			}
			add_war_support = 0.03
		   	171 = { add_core_of = ROOT }
		}
	}
}

political_actions = {
	POR_become_portugal = {

		icon = generic_nationalism

		allowed = {
			original_tag = POR
		}

		available = {
			OR = {
				owns_state = 179
				owns_state = 795
				owns_state = 112
				owns_state = 181
				owns_state = 180
			}
		}
		
		fire_only_once = yes	
		visible = {
			has_cosmetic_tag = POR_AZORES
		}

		complete_effect = {				
			drop_cosmetic_tag = yes		
			add_political_power = 25
			add_stability = 0.03					
		}			
		ai_will_do = {
			base = 50
		}
	}
}

POR_foreign_policy = {
	POR_support_the_spanish_nationalists_r56 = {
		icon = generic_nationalism
		fire_only_once = yes
		cost = 40	

		visible = {
			NOT = { 
				has_global_flag = scw_over
				has_completed_focus = POR_unite_against_salazar 
			}
		}

		available = {
			country_exists = SPA
			SPR_scw_in_progress = yes
			OR = {
				has_completed_focus = POR_continue_salazars_policies
				has_completed_focus = POR_unlatch_salazars_grip
			}
		}

		complete_effect = {	
			add_relation_rule_override = {
                target = SPA
                can_send_volunteers = yes 
            }
			custom_effect_tooltip = CHL_skip_one_line_tt
			add_ideas = POR_supporting_the_spanish_nationalists
			add_ai_strategy = {
				type = send_volunteers_desire
				id = "SPA"
				value = 200
			}							
		}			
		ai_will_do = { base = 500 }
	}

	POR_come_to_britains_aid = {
		icon = generic_nationalism
		fire_only_once = yes
		visible = {
			is_in_faction = no
			ENG = { is_in_faction = yes }
		}
		targets = { ENG }
		available = {
			if = {
				limit = {
					OR = {
						ENG = { has_government = fascism }
						POR = { has_government = fascism }
					}
				}
				ENG = { has_government = fascism }
				POR = { has_government = fascism }
			}
			else_if = {
				limit = {
					OR = {
						ENG = { has_government = communism }
						POR = { has_government = communism }
					}
				}
				ENG = { has_government = communism }
				POR = { has_government = communism }
			}
			else = {
				OR = {
					has_completed_focus = POR_continue_salazars_policies
					has_completed_focus = POR_restore_civil_liberties
				}
			}
		}

		complete_effect = {				
			ENG = {
				country_event = { id = portugal.30 }
			}					
		}			
		ai_will_do = {
			base = 0
			modifier = {
				add = 500
				OR = {
					ENG = { is_in_faction_with = GER }
					ENG = { is_in_faction_with = WGR }
					NOT = {
						GER = { has_government = fascism }	 
					}
				}
			}
		}
	}

	POR_request_axis_membership = {
		icon = generic_nationalism
		fire_only_once = yes
		visible = {
			has_government = fascism
			is_in_faction = no
			GER = { 
				is_in_faction = yes
				has_government = fascism 
			}
			NOT = { 
				GER = { is_in_faction_with = ENG }
			}
		}
		targets = { GER }
		complete_effect = {				
			GER = {
				country_event = { id = portugal.10 }
			}					
		}			
		ai_will_do = {
			base = 0
			modifier = {
				add = 500
				AND = {
					GER = { is_in_faction_with = ITA }
					OR = {
						ENG = { has_government = communism }
						771 = { is_claimed_by = POR }
					}
				}
			}
		}
	}

	POR_ally_the_italians = {
		icon = generic_nationalism
		fire_only_once = yes
		visible = {
			has_government = fascism
			is_in_faction = no
			ITA = { 
				is_in_faction = yes
				has_government = fascism 
			}
			NOT = { 
				ITA = { is_in_faction_with = ENG }
				ITA = { is_in_faction_with = GER }
			}
		}
		targets = { ITA }
		complete_effect = {				
			GER = {
				country_event = { id = generic.2 }
			}					
		}			
		ai_will_do = {
			base = 0
			modifier = {
				add = 500
				OR = {
					ENG = { has_government = communism }
					771 = { is_claimed_by = POR }
				}
			}
		}
	}

	POR_ally_the_soviet_union = {
		icon = generic_nationalism
		fire_only_once = yes
		visible = {
			has_government = communism
			is_in_faction = no
			SOV = { 
				is_in_faction = yes
				has_government = communism
			}
		}
		targets = { SOV }
		available = { has_completed_focus = POR_defang_the_liberals }
		complete_effect = {				
			SOV = {
				country_event = { id = generic.2 }
			}					
		}			
		ai_will_do = {
			base = 0
			modifier = {
				add = 500
				SOV = { surrender_progress < 0.15 }
			}
		}
	}
}

POR_the_path_to_economic_progress = {
	POR_sell_off_seized_assets = {
		icon = eng_trade_unions_support
		fire_only_once = no
		days_re_enable = 90
		ai_will_do = { base = 500 }
		visible = { 
			OR = {
				has_idea = POR_heavy_handed_central_planning
				has_idea = POR_looming_economic_disaster
			}
		}
		days_remove = 105
		modifier = {
			political_power_factor = 0.1
			consumer_goods_factor = -0.05
		}
		remove_effect = {
			if = {
				limit = { 
					has_idea = POR_looming_economic_disaster
				}
				swap_ideas = {
					remove_idea = POR_looming_economic_disaster
					add_idea = POR_heavy_handed_central_planning
				}
			}
			else_if = {
				limit = { 
					has_idea = POR_heavy_handed_central_planning
				}
				swap_ideas = {
					remove_idea = POR_heavy_handed_central_planning
					add_idea = POR_moderate_collectivization
				}
			}
			else = {
				swap_ideas = {
					remove_idea = POR_moderate_collectivization
					add_idea = POR_transitioning_to_a_mixed_economy
				}
			}
		}
	}

	POR_factory_recruitment_drive = {
		icon = generic_military
		fire_only_once = no
		days_re_enable = 60
		cost = 40
		ai_will_do = { base = 50 }
		visible = { has_completed_focus = POR_exasperate_the_industrialization }
		available = {
			NOT = {
				has_idea = POR_heavy_handed_central_planning
				has_idea = POR_looming_economic_disaster
			}
		}
		days_remove = 105
		modifier = {
			industrial_capacity_factory = 0.1
			production_factory_efficiency_gain_factor = 0.15
		}
	}

	POR_invest_in_public_education = {
		icon = GFX_decision_generic_book
		fire_only_once = no
		cost = 40
		ai_will_do = { base = 25 }
		visible = { has_completed_focus = POR_rebuild_the_social_state }
		days_remove = 120
		modifier = {
			research_speed_factor = 0.04
			stability_weekly = 0.002
			political_power_gain = -0.25
		}
		remove_effect = {
			add_popularity = {
				ideology = ROOT
				popularity = 0.02
			}
		}
	}

	POR_support_private_collectives = {
		icon = generic_political_discourse
		fire_only_once = no
		cost = 60
		ai_will_do = { base = 30 }
		visible = { has_completed_focus = POR_begin_nationalization_efforts }
		days_remove = 105
		modifier = {
			political_power_gain = -0.15
			consumer_goods_factor = -0.1
		}
		remove_effect = {
			if = {
				limit = { 
					has_idea = POR_the_question_of_nationalization_idea
				}
				swap_ideas = {
					remove_idea = POR_the_question_of_nationalization_idea
					add_idea = POR_transitioning_to_a_mixed_economy
				}
			}
			else_if = {
				limit = { 
					has_idea = POR_moderate_collectivization
				}
				swap_ideas = {
					remove_idea = POR_moderate_collectivization
					add_idea = POR_transitioning_to_a_mixed_economy
				}
			}
			else_if = {
				limit = { 
					has_idea = POR_heavy_handed_central_planning
				}
				swap_ideas = {
					remove_idea = POR_heavy_handed_central_planning
					add_idea = POR_moderate_collectivization
				}
			}
			else_if = {
				limit = { 
					has_idea = POR_looming_economic_disaster
				}
				swap_ideas = {
					remove_idea = POR_looming_economic_disaster
					add_idea = POR_heavy_handed_central_planning
				}
			}
			else = {
				add_stability = 0.03
				add_popularity = {
					ideology = ROOT
					popularity = 0.02
				}
			}
		}
	}

	POR_land_redistribution = {
		icon = GFX_decision_generic_welfare
		fire_only_once = no
		cost = 60
		ai_will_do = { base = 50 }
		visible = { has_completed_focus = POR_begin_nationalization_efforts }
		days_remove = 105
		modifier = {
			stability_weekly = 0.005
			civilian_factory_use = 1
			political_power_factor = -0.1
		}
		remove_effect = {
			if = {
				limit = { 
					has_idea = POR_the_question_of_nationalization_idea
				}
				swap_ideas = {
					remove_idea = POR_the_question_of_nationalization_idea
					add_idea = POR_moderate_collectivization
				}
			}
			else_if = {
				limit = { 
					has_idea = POR_transitioning_to_a_mixed_economy
				}
				swap_ideas = {
					remove_idea = POR_transitioning_to_a_mixed_economy
					add_idea = POR_moderate_collectivization
				}
			}
			else_if = {
				limit = { 
					has_idea = POR_moderate_collectivization
				}
				swap_ideas = {
					remove_idea = POR_moderate_collectivization
					add_idea = POR_heavy_handed_central_planning
				}
			}
			else_if = {
				limit = { 
					has_idea = POR_heavy_handed_central_planning
				}
				swap_ideas = {
					remove_idea = POR_heavy_handed_central_planning
					add_idea = POR_looming_economic_disaster
				}
			}
			else = {
				add_stability = -0.05
				add_popularity = {
					ideology = ROOT
					popularity = 0.03
				}
			}
		}
	}

	POR_direct_farmland_to_industrial_projects = {
		icon = eng_trade_unions_demand
		fire_only_once = no
		days_re_enable = 365
		cost = 75
		ai_will_do = { base = 50 }
		visible = { has_completed_focus = POR_exasperate_the_industrialization }
		days_remove = 120
		remove_effect = {
			if = {
				limit = { 
					has_idea = POR_the_question_of_nationalization_idea
				}
				swap_ideas = {
					remove_idea = POR_the_question_of_nationalization_idea
					add_idea = POR_moderate_collectivization
				}
			}
			else_if = {
				limit = { 
					has_idea = POR_transitioning_to_a_mixed_economy
				}
				swap_ideas = {
					remove_idea = POR_transitioning_to_a_mixed_economy
					add_idea = POR_moderate_collectivization
				}
			}
			else_if = {
				limit = { 
					has_idea = POR_moderate_collectivization
				}
				swap_ideas = {
					remove_idea = POR_moderate_collectivization
					add_idea = POR_heavy_handed_central_planning
				}
			}
			else_if = {
				limit = { 
					has_idea = POR_heavy_handed_central_planning
				}
				swap_ideas = {
					remove_idea = POR_heavy_handed_central_planning
					add_idea = POR_looming_economic_disaster
				}
			}
			else = {
				add_stability = -0.05
				add_popularity = {
					ideology = ROOT
					popularity = 0.03
				}
			}
			random_owned_controlled_state = {
				limit = {
					OR = {
						state = 179
						state = 795
						state = 181
					}
				}
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = arms_factory
					level = 1
					instant_build = yes
				}
			}
		}
	}
}

POR_together_against_salazar = {
	POR_request_soviet_assistance = {
		icon = eng_trade_unions_support
		fire_only_once = no
		days_re_enable = 75
		ai_will_do = { base = 200 }
		visible = { has_completed_focus = POR_seek_foreign_support }
		available = {
			SOV = { has_completed_focus = SOV_the_comintern }
		}
		complete_effect = {
			SOV = { 
				country_event = { id = portugal.46 } 
			}
		}
	}

	POR_battle_nationalist_paramilitaries = {
		icon = generic_prepare_civil_war
		fire_only_once = no
		days_re_enable = 80
		ai_will_do = { base = 15 }
		days_remove = 50
		remove_effect = {
			add_political_power = 50
			add_stability = -0.03
			custom_effect_tooltip = CHL_skip_one_line_tt
			add_popularity = {
				ideology = communism
				popularity = 0.025
			}
			add_popularity = {
				ideology = democratic
				popularity = 0.02
			}
			add_popularity = {
				ideology = fascism
				popularity = 0.02
			}
		}
	}

	POR_call_for_general_strike = {
		icon = eng_trade_unions_demand
		fire_only_once = no
		ai_will_do = { base = 5 }
		available = { communism > 0.2 }
		cancel_trigger = { has_completed_focus = POR_storm_the_national_assembly }
		days_remove = -1
		modifier = {
			political_power_factor = 0.2
			communism_drift = 0.03
			democratic_drift = 0.03
			stability_weekly = -0.001
			production_speed_buildings_factor = -0.15
			industrial_capacity_factory = -0.15
		}
	}

	POR_join_forces_with_the_spanish_popular_front = {
		icon = eng_trade_unions_support
		fire_only_once = yes
		ai_will_do = { base = 100 }
		cost = 45
		visible = { has_completed_focus = POR_seek_foreign_support }
		available = {
			country_exists = SPR
			NOT = { has_global_flag = scw_over }
		}
		complete_effect = {
			set_country_flag = POR_join_forces_with_the_spanish_popular_front_flag
			custom_effect_tooltip = POR_join_forces_with_the_spanish_popular_front_tt
			custom_effect_tooltip = CHL_skip_one_line_tt
			effect_tooltip = {
				every_country = {
					limit = {
						OR = { 
							original_tag = POR
							original_tag = SPD
							AND = {
								original_tag = SPR
								OR = {
									has_government = democratic
									has_government = communism
								}
							}
						}
					}
					add_timed_idea = { idea = POR_iberian_workers_united days = 730 }
				}
			}
		}
	}

	POR_distribute_propaganda_pamphlets = {
		icon = eng_propaganda_campaigns
		fire_only_once = no
		ai_will_do = { base = 5 }
		cost = 55
		days_remove = 115
		modifier = {
			communism_drift = 0.03
			democratic_drift = 0.02
			political_power_gain = -0.12
		}
	}
}

POR_restoring_valiance_to_portugal = {
	POR_rally_the_monarchists_of_porto = {
		icon = GFX_decision_CHL_carabineros
		fire_only_once = no
		days_re_enable = 40
		cost = 65
		visible = { has_country_flag = POR_declare_support_for_the_monarchist_cause_flag }
		highlight_states = {
			highlight_state_targets = {
				state = 180
			}
		}
		days_remove = 80
		cancel_trigger = { has_completed_focus = POR_unlatch_salazars_grip }
		remove_effect = {
			if = {
				limit = { 
					NOT = { has_country_flag = POR_expand_pro_monarchist_rally_flag }
				}
				add_stability = -0.025
				add_popularity = {
					ideology = fascism
					popularity = 0.04
				}
				set_country_flag = POR_expand_pro_monarchist_rally_flag
				custom_effect_tooltip = CHL_skip_one_line_tt
				unlock_decision_tooltip = POR_spread_monarchist_propaganda
			}
			else = {
				add_political_power = 30
				add_popularity = {
					ideology = fascism
					popularity = 0.05
				}
			}
		}
		ai_will_do = { base = 10 }
	}

	POR_spread_monarchist_propaganda = {
		icon = generic_operation
		fire_only_once = no
		cost = 40
		visible = { has_country_flag = POR_expand_pro_monarchist_rally_flag }
		days_remove = 65
		cancel_trigger = { has_completed_focus = POR_unlatch_salazars_grip }
		remove_effect = {
			add_popularity = {
				ideology = fascism
				popularity = 0.035
			}
			set_country_flag = POR_unlock_pro_monarchist_rally_guarda
		}
		ai_will_do = { base = 10 }
	}

	POR_antagonize_socialist_organizations = {
		icon = generic_prepare_civil_war
		fire_only_once = no
		days_re_enable = 35
		cost = 65
		visible = { has_country_flag = POR_arm_blueshirts_militias_flag }
		complete_effect = { set_country_flag = POR_antagonize_socialist_organizations_ongoing_flag }

		days_remove = 35
		cancel_trigger = { has_completed_focus = POR_unlatch_salazars_grip }
		remove_effect = {
			add_stability = -0.05
			add_popularity = {
				ideology = fascism
				popularity = 0.06
			}
			add_popularity = {
				ideology = communism
				popularity = 0.035
			}
			clr_country_flag = POR_antagonize_socialist_organizations_ongoing_flag
		}

		ai_will_do = {
			base = 0
		}
	}
}
